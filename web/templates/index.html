<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            java: '#d4a574',
            jquery: '#54aeff',
            modern: '#b392f0'
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <style>
    /* Compact code blocks */
    .knowledge-code code {
      line-height: 1.1 !important;
    }

    .knowledge-code pre {
      line-height: 1.1 !important;
    }
  </style>
</head>

<body class="h-screen overflow-hidden grid grid-rows-[auto_1fr] font-mono bg-slate-100 text-slate-800">
  <div class="flex gap-[1px] border-b border-blue-600 overflow-hidden">
    <!-- Java Section: 1/3 width -->
    <div class="w-1/3 p-0.5 flex flex-col overflow-hidden bg-java/20">
      <div class="text-[8px] uppercase tracking-wider text-slate-600">{{ .JavaBit.Category }}</div>
      <div class="font-bold text-[9px] leading-tight text-slate-700">{{ .JavaBit.Title }}</div>
      <div class="text-[8px] leading-tight text-slate-600">{{ .JavaBit.Description }}</div>
      {{ if .JavaBit.Code }}
      <pre
        class="knowledge-code bg-white p-0.5 rounded border-l-4 border-java text-[7px] font-mono whitespace-pre-wrap break-words shadow-inner"><code class="language-java">{{ .JavaBit.Code }}</code></pre>
      {{ end }}
    </div>

    <!-- jQuery Section: 2/3 width -->
    <div class="w-2/3 flex flex-col gap-[1px] overflow-hidden">
      <!-- Header with title and description -->
      <div class="p-0.5 bg-jquery/20">
        <div class="text-[8px] uppercase tracking-wider text-slate-600">{{ .JQueryBit.Category }}</div>
        <div class="font-bold text-[9px] leading-tight text-slate-700">{{ .JQueryBit.Title }}</div>
        <div class="text-[8px] leading-tight text-slate-600">{{ .JQueryBit.Description }}</div>
      </div>

      <!-- Code sections: jQuery on left, Modern+HTML on right -->
      <div class="flex-1 flex gap-[1px] overflow-hidden">
        {{ if .JQueryBit.JQueryCode }}
        <!-- jQuery Code (left side) -->
        <div class="flex-1 p-0.5 flex flex-col overflow-hidden bg-jquery/10">
          <pre
            class="knowledge-code flex-1 bg-white p-0.5 rounded border-l-4 border-jquery text-[7px] font-mono whitespace-pre-wrap break-words shadow-inner"><code class="language-javascript">{{ .JQueryBit.JQueryCode }}</code></pre>
        </div>
        {{ end }}

        {{ if or .JQueryBit.HTMLCode .JQueryBit.ModernCode }}
        <!-- Modern + HTML Code (right side) -->
        <div class="flex-1 p-0.5 flex flex-col bg-modern/10">
          {{ if .JQueryBit.HTMLCode }}
          <div class="text-[8px] uppercase tracking-wider text-slate-600 mb-0.5">HTML</div>
          <pre
            class="knowledge-code bg-white p-0.5 rounded border-l-4 border-modern text-[7px] font-mono whitespace-pre-wrap break-words shadow-inner"><code class="language-html">{{ .JQueryBit.HTMLCode }}</code></pre>
          {{ end }}
          {{ if .JQueryBit.ModernCode }}
          <div class="text-[8px] uppercase tracking-wider text-slate-600 mt-1 mb-0.5">Modern</div>
          <pre
            class="knowledge-code bg-white p-0.5 rounded border-l-4 border-modern text-[7px] font-mono whitespace-pre-wrap break-words shadow-inner"><code class="language-javascript">{{ .JQueryBit.ModernCode }}</code></pre>
          {{ end }}
        </div>
        {{ end }}
      </div>
    </div>
  </div>
  <div class="flex-1 min-h-0 overflow-auto grid gap-[2px] grid-cols-3 md:grid-cols-4 lg:grid-cols-5"
    data-count="{{ len .Sources }}">
    {{ if .Sources }}
    {{ range .Sources }}
    <div class="bg-white border border-slate-300 flex flex-col overflow-hidden" {{ if .NSFW
      }}style="background-color: #fff5f5; border-color: #cf222e;" {{ else if .IgnoreDays
      }}style="background-color: #fff8e6; border-color: #e3a008;" {{ else }}style="background-color: #fff;" {{ end }}>
      <div class="px-3 py-2 border-b flex justify-between items-center text-[12px] font-bold uppercase tracking-wider"
        {{ if .NSFW }}style="background-color: #fff5f5; border-bottom-color: #cf222e; color: #82071e;" {{ else if
        .IgnoreDays }}style="background-color: #fff8e6; border-bottom-color: #e3a008; color: #92400e;" {{ else
        }}style="background-color: #f6f8fa; border-bottom-color: #d0d7de;" {{ end }}>
        <span>{{ .Name }}</span>
        <span class="text-[10px] font-normal opacity-70">{{ if .IgnoreDays }}‚àû{{ else }}{{ .Days }}d{{ end }}</span>
      </div>
      <div class="flex-1 overflow-y-auto p-2">
        {{ if .Error }}
        <div class="rounded p-4 m-4 flex gap-3" style="background-color: #fff1f0; border: 1px solid #ff8182;">
          <div class="text-[24px] flex-shrink-0">‚ö†Ô∏è</div>
          <div class="text-[12px] leading-relaxed break-words" style="color: #d1242f;">{{ .Error }}</div>
        </div>
        {{ else if .Items }}
        {{ range .Items }}
        <div class="border-l-2 p-2 mb-2 transition-colors hover:border-blue-600 hover:bg-slate-100"
          style="border-left-color: #d0d7de;">
          <div class="text-[13px] mb-1">
            <a href="{{ .Link }}" target="_blank" rel="noopener noreferrer" style="color: #0550ae;">{{ .Title }}</a>
          </div>
          <div class="text-[10px]" style="color: #57606a;">{{ formatTimeAgo .Published }}</div>
        </div>
        {{ end }}
        {{ else }}
        <div class="text-center py-10" style="color: #57606a;">No items</div>
        {{ end }}
      </div>
    </div>
    {{ end }}
    {{ else }}
    <div class="tile bg-white border border-slate-300">
      <div class="tile-content p-2 flex-1">
        <div class="empty text-center text-slate-500 py-10">No sources configured</div>
      </div>
    </div>
    {{ end }}
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
    const eventSource = new EventSource('/events');

    eventSource.onmessage = function(event) {
      if (event.data === 'update') {
        window.location.reload();
      }
    };

    eventSource.onerror = function(error) {
      console.error('SSE error:', error);
      setTimeout(() => {
        window.location.reload();
      }, 5000);
    };
  </script>
</body>

</html>